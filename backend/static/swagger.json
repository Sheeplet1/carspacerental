{
  "swagger": "2.0",
  "info": {
    "version": "1.0.0",
    "title": "Car Space Renting System API",
    "description": "Server for Car Space Renting System"
  },
  "tags": [
    {
      "name": "Auth",
      "description": "Managing user authentication and authorisation"
    },
    {
      "name": "Users",
      "description": "Managing user information"
    },
    {
      "name": "Listings",
      "description": "Managing listings"
    },
    {
      "name": "Bookings",
      "description": "Managing bookings"
    }
  ],
  "schemes": [
    "http"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "AuthToken": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "Authorization Bearer Token"
          }
        }
      }
    },
    "fields": {
      "Email": {
        "type": "string",
        "description": "Email address of the user",
        "example": "name@unsw.edu.au",
      },
      "Password": {
        "type": "string",
        "description": "Password of the user",
        "example": "password"
      },
      "FirstName": {
        "type": "string",
        "description": "First Name of the user",
        "example": "FirstName"
      },
      "LastName": {
        "type": "string",
        "description": "Last Name of the user",
        "example": "FirstName"
      },
      "PhoneNumber": {
        "type": "string",
        "description": "Number of the user",
        "example": "0412345678"
      },
      "ListingId": {
        "type": "string",
        "description": "ID of the listing (generated by bson)",
        "example": "5507c7f79bcf86cd7994f6c0e"
      },
      "ListingProviderName": {
        "type": "string",
        "description": "Name of the Listing Provider",
        "example": "First Last",
      },
      "ListingProviderId": {
        "type": "string",
        "description": "ObjectID of the Listing Provider",
        "example": "5507c7f79bcf86cd7994f6c0e"
      },
      "ListingSize": {
        "type": "string",
        "description": "Size of the parking space",
        "example": "SUV"
      },
      "ListingAccess": {
        "type": "string",
        "description": "Access type of the parking space",
        "example": "passcode"
      },
      "ListingAddress": {
        "type": "object",
        "description": "Address of the listing"
      },
      "ListingDescription": {
        "type": "string",
        "description": "Description of listing"
      },
      "ListingPrice": {
        "type": "number",
        "description": "Price of the listing per day",
        "example": 350
      },
      "ListingImages": {
        "type": "array",
        "description": "Images of the listing - stored as base64",
        "example": "[data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==]"
      },
      "ListingFeatures": {
        "type": "array",
        "description": "Additional features, e.g. electric charging"
      },
      "ListingReviews": {
        "type": "array",
        "description": "All of the user reviews related to a listing",
        "items": {
          "type": "object"
        }
      },
      "ListingAvailability": {
        "type": "array",
        "description": "TO BE EDITED!!!! - Date ranges between which a listing is available for bookings",
        "items": {
          "type": "object"
        }
      },
      "BookingId": {
        "type": "string",
        "description": "ID of the booking",
        "example": "5507c7f79bcf86cd7994f6c0e"
      },
      "BookingProviderName": {
        "type": "string",
        "example": "lily@unsw.edu.au",
        "description": "Email address of the user who made the booking"
      },
      "UserId": {
        "type": "string",
        "description": "ID of the user",
        "example": "5507c7f79bcf86cd7994f6c0e"
      },
      "BookingDateRange": {
        "type": "object",
        "description": "The dates for which the booking was made"
      },
      "BookingTotalPrice": {
        "type": "number",
        "example": 800,
        "description": "Total price of the booking"
      },
      "BookingStatus": {
        "type": "string",
        "example": "accepted",
        "description": "Status of the booking"
      }
    },
    "parameters": {
      "AuthRegisterBody": {
        "name": "Register Info",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "email": {
              "$ref": "#/components/fields/Email"
            },
            "password": {
              "$ref": "#/components/fields/Password"
            },
            "first_name": {
              "$ref": "#/components/fields/FirstName"
            },
            "last_name": {
              "$ref": "#/components/fields/LastName"
            },
            "phone_number": {
              "$ref": "#/components/fields/PhoneNumber"
            }
          }
        }
      },
      "AuthLoginBody": {
        "name": "Login Info",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "email": {
              "$ref": "#/components/fields/Email"
            },
            "password": {
              "$ref": "#/components/fields/Password"
            }
          }
        }
      },
      "Token": {
        "name": "token",
        "in": "header",
        "schema": {
          "type": "string",
          "example": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImhheWRlbkB1bnN3LmVkdS5hdSIsImlhdCI6MTYwMzk0MzIzMH0.b37PfwlcH_cue6yhgvDt2IiNvhRACf79hTNtacYB94Q"
        },
        "required": true,
        "description": "Bearer [token]"
      },
      "ListingsGetAll": {
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {}
        }
      },
      "UserIdQuery": {
        "in": "path",
        "name": "userid",
        "required": true,
        "schema": {
          "type": "string",
          "minimum": 1,
          "maximum": 1
        },
        "example": "5507c7f79bcf86cd7994f6c0e",
        "description": "ID of the user"
      },
      "ListingsIdQuery": {
        "in": "path",
        "name": "listingid",
        "required": true,
        "schema": {
          "type": "string",
          "minimum": 1,
          "maximum": 1
        },
        "example": "5507c7f79bcf86cd7994f6c0e",
        "description": "ID of the listing"
      },
      "ListingsNew": {
        "name": "New listing body",
        "description": "Create a New Listing",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "address": {
              "$ref": "#/components/fields/ListingAddress"
            },
            "price": {
              "$ref": "#/components/fields/ListingPrice"
            },
            "thumbnail": {
              "$ref": "#/components/fields/ListingThumbnail"
            },
            "metadata": {
              "$ref": "#/components/fields/ListingMetadata"
            }
          }
        }
      },
      "ListingsPut": {
        "name": "Listing details",
        "description": "A list of listing details to be updated - the address and metadata schemas are defined by the client",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "address": {
              "$ref": "#/components/fields/ListingAddress"
            },
            "thumbnail": {
              "$ref": "#/components/fields/ListingThumbnail"
            },
            "price": {
              "$ref": "#/components/fields/ListingPrice"
            },
            "metadata": {
              "$ref": "#/components/fields/ListingMetadata"
            }
          }
        }
      },
      "PublishListingBody": {
        "name": "Availability object",
        "description": "List of date ranges when listing is available for bookings - ranges schemas are defined by the client",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "availability": {
              "$ref": "#/components/fields/ListingAvailability"
            }
          }
        }
      },
      "PostReviewBody": {
        "name": "Review object",
        "description": "A single listing review that will be added to the listing's review array - schema of the review defined by the client",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "text": {
              "type": "string"
            },
            "rating": {
              "type": "integer"
            }
          }
        }
      },
      "BookingIdQuery": {
        "in": "path",
        "name": "bookingid",
        "required": true,
        "schema": {
          "type": "integer",
          "minimum": 1,
          "maximum": 1
        },
        "example": 312894,
        "description": "ID of the booking"
      },
      "BookingsNew": {
        "name": "Booking details",
        "description": "Booking details required to make a new booking - schema for the booking date range is defined by the client",
        "in": "body",
        "schema": {
          "type": "object",
          "properties": {
            "dateRange": {
              "$ref": "#/components/fields/BookingDateRange"
            },
            "totalPrice": {
              "$ref": "#/components/fields/BookingTotalPrice"
            }
          }
        }
      }
    },
    "responses": {
      "200": {
        "Token": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {
              "token": {
                "type": "string",
                "description": "JWT Token to provide authorisation",
                "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImhheWRlbkB1bnN3LmVkdS5hdSIsImlhdCI6MTYwMzk0MzIzMH0.b37PfwlcH_cue6yhgvDt2IiNvhRACf79hTNtacYB94Q"
              }
            }
          }
        },
        "Empty": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {}
          }
        },
        "ListingsGetAll": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {
              "listings": {
                "type": "array",
                "description": "List of all quizzes",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "$ref": "#/components/fields/ListingId"
                    },
                    "provider": {
                      "$ref": "#/components/fields/ListingProviderName"
                    },
                    "address": {
                      "$ref": "#/components/fields/ListingAddress"
                    },
                    "thumbnail": {
                      "$ref": "#/components/fields/ListingThumbnail"
                    },
                    "price": {
                      "$ref": "#/components/fields/ListingPrice"
                    },
                    "reviews": {
                      "$ref": "#/components/fields/ListingReviews"
                    }
                  }
                }
              }
            }
          }
        },
        "ListingsGet": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {
              "provider": {
                "$ref": "#/components/fields/ListingProviderName"
              },
              "address": {
                "$ref": "#/components/fields/ListingAddress"
              },
              "price": {
                "$ref": "#/components/fields/ListingPrice"
              },
              "thumbnail": {
                "$ref": "#/components/fields/ListingThumbnail"
              },
              "metadata": {
                "$ref": "#/components/fields/ListingMetadata"
              },
              "reviews": {
                "$ref": "#/components/fields/ListingReviews"
              },
              "availability": {
                "$ref": "#/components/fields/ListingAvailability"
              },
              "published": {
                "$ref": "#/components/fields/ListingPublished"
              },
              "postedOn": {
                "$ref": "#/components/fields/ListingPostedOn"
              }
            }
          }
        },
        "ListingsNew": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {
              "listingId": {
                "$ref": "#/components/fields/ListingId"
              }
            }
          }
        },
        "BookingsGetAll": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {
              "bookings": {
                "type": "array",
                "description": "List of all bookings",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "$ref": "#/components/fields/BookingId"
                    },
                    "provider": {
                      "$ref": "#/components/fields/BookingProviderName"
                    },
                    "dateRange": {
                      "$ref": "#/components/fields/BookingDateRange"
                    },
                    "totalPrice": {
                      "$ref": "#/components/fields/BookingTotalPrice"
                    },
                    "listingId": {
                      "$ref": "#/components/fields/ListingId"
                    },
                    "status": {
                      "$ref": "#/components/fields/BookingStatus"
                    }
                  }
                }
              }
            }
          }
        },
        "BookingsNew": {
          "description": "OK",
          "schema": {
            "type": "object",
            "properties": {
              "bookingId": {
                "$ref": "#/components/fields/BookingId"
              }
            }
          }
        }
      },
      "400": {
        "description": "Bad Input",
        "schema": {
          "type": "object",
          "properties": {
            "error": {
              "type": "string",
              "description": "Error message returned from server",
              "example": "Invalid input"
            }
          }
        }
      },
      "403": {
        "description": "Forbidden",
        "schema": {
          "type": "object",
          "properties": {
            "error": {
              "type": "string",
              "description": "Error message returned from server",
              "example": "Invalid Token"
            }
          }
        }
      }
    }
  },
  "paths": {
    "/auth/register": {
      "post": {
        "summary": "Register a new user",
        "tags": [
          "Auth"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AuthRegisterBody"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Token"
          },
          "400": {
            "$ref": "#/components/responses/400"
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "summary": "Login a user",
        "tags": [
          "Auth"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AuthLoginBody"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Token"
          },
          "400": {
            "$ref": "#/components/responses/400"
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "summary": "Logout a User",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Auth"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/user/{userid}": {
      "get": {
        "summary": "Get information for a specific user",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdQuery"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/UserGet"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      },
      "put": {
        "summary": "Update user information",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/UserIdQuery"
          },
          {
            "$ref": "#/components/parameters/UserPut"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      },
      "delete": {
        "summary": "Delete a user account",
        "tags": [
          "Users"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/UserIdQuery"
          },
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/listings": {
      "get": {
        "summary": "Get a list of all car spaces",
        "tags": [
          "Listings"
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/ListingsGetAll"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/listings/new": {
      "post": {
        "summary": "Create a new car space listing",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Listings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/ListingsNew"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/ListingsNew"
          },
          "400": {
            "$ref": "#/components/responses/400"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/listings/{listingid}": {
      "get": {
        "summary": "Get information for a specific listing",
        "tags": [
          "Listings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ListingsIdQuery"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/ListingsGet"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      },
      "put": {
        "summary": "Update the details for a car space listing",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Listings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/ListingsIdQuery"
          },
          {
            "$ref": "#/components/parameters/ListingsPut"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "400": {
            "$ref": "#/components/responses/400"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      },
      "delete": {
        "summary": "Delete a listing",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Listings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/ListingsIdQuery"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "400": {
            "$ref": "#/components/responses/400"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/listings/{listingid}/review/{bookingid}": {
      "put": {
        "summary": "Post a new listing review",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Listings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/ListingsIdQuery"
          },
          {
            "$ref": "#/components/parameters/BookingIdQuery"
          },
          {
            "$ref": "#/components/parameters/PostReviewBody"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "400": {
            "$ref": "#/components/responses/400"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/bookings": {
      "get": {
        "summary": "Get a list of all bookings",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Bookings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/BookingsGetAll"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/bookings/{userid}": {
      "get": {
        "summary": "Get a list of all bookings from a specific user",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Bookings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UserIdQuery"
          },
          {
            "$ref": "#/components/parameters/Token"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/BookingGet"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/bookings/new/{listingid}": {
      "post": {
        "summary": "Create a new booking for a car space",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Bookings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/ListingsIdQuery"
          },
          {
            "$ref": "#/components/parameters/BookingsNew"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/BookingsNew"
          },
          "400": {
            "$ref": "#/components/responses/400"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    },
    "/bookings/{bookingid}": {
      "delete": {
        "summary": "Delete a particular car space booking",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "tags": [
          "Bookings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Token"
          },
          {
            "$ref": "#/components/parameters/BookingIdQuery"
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/components/responses/200/Empty"
          },
          "400": {
            "$ref": "#/components/responses/400"
          },
          "403": {
            "$ref": "#/components/responses/403"
          }
        }
      }
    }
  }
}
